<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="fragments :: head">
    <meta charset="UTF-8">
    <title>Post Page</title>
</head>
<body>
    <navbar th:replace="fragments :: header"></navbar>
        <section class="content">
            <div class="post-info">
                <a th:href="@{/profile(username=${post.author})}">
                    <p th:text="${post.author}"></p>
                </a>
                <p th:text="${#dates.format(post.timeAdded, 'dd-MM-yyyy HH:mm')}"></p>
            </div>
            <a th:text="${post.title}"></a>
            <p th:text="${post.content}"></p>
            <hr>
            <div class="comments">
                <h3>Comments</h3>
                <div sec:authorize="isAuthenticated()">
                    <form method="post" th:action="@{{id}/save-comment(id = ${post.id})}" th:object="${comment}">
                        <textarea th:field="*{content}" placeholder="add comment"></textarea>
                        <button type="submit">Add comment</button>
                    </form>
                </div>
                <div sec:authorize="!isAuthenticated()">
                    <h4>Log in to add a comment!</h4>
                </div>
                <div class="comment">
                    <div th:each="comment : ${comments}">
                        <div class="comment-details">
                            <p th:text="${comment.username}">username</p>
                            <p th:text="${#dates.format(comment.timeAdded, 'dd-MM-yyyy HH:mm')}">dd-MM-yyyy</p>
                        </div>
                        <p id="comment-content" th:text="${comment.content}">dd/mm/yyyy</p>
                    </div>
                </div>
            </div>
        </section>
</body>
</html>